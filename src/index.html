<!--
Copyright (c) 2016-2017 Tyler Milford. All rights reserved.
This source code is subject to the terms of the Mozilla Public License, v. 2.0
as found in the LICENSE file or at: http://mozilla.org/MPL/2.0
-->

<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>reAMP</title>
		<link rel="stylesheet" href="css/font-awesome.min.css">
        <link rel="stylesheet" href="css/material-icons.css">
		<link rel="stylesheet" type="text/css" href="css/main.css">
	</head>

	<body>
		<div id="container">

			<div id="header">
				<!-- put close, minimize, draggable button here -->
				<button id="close" title="Close" onclick="remote.getCurrentWindow().hide();"><i class="fa fa-close"></i></button>
			</div>

			<div id="content">

				<div id="leftPane">
					<div id="playlistContainer" v-if="playlistVisible">
						<h4>Play Queue</h4>
						<ol id="playlist" v-sortable="{}">
							<li v-for="track in playlist" :data-id="track._id" :key="track._id" @dblclick="play(track)" @contextmenu.prevent="playNext(track)" :class="[( track._id === currentTrack ) ? 'activeGreen' : '']">
								{{ track.artist }} - {{ track.title }}
							</li>
						</ol>
					</div>

					<div id="visualizer">
						<canvas id="canvas" width="600" height="400">
							analyser
						</canvas>
					</div>

					<div id ="albumart"></div>

					<div id="status" :title="nowPlaying">
						{{ nowPlaying }}
					</div>

					<div id="duration">
						<!--{{ currentTime }} / {{ duration }} | -->
						{{ remainingTime }} {{ bitRate }}
					</div>
				</div>

				<div id="rightPane">
					<div id="foldersContainer">
						<ul id="demo">
							<item class="item" :model="libraryFolders"></item>
						</ul>
					</div>
				</div>

			</div>

			<div id="footer">
				<div id="controls">
					<button onclick="setLibraryPath();" title="Select Library Folder"><i class="fa fa-lg fa-folder-open-o"></i></button>
					<button onclick="status.playlistVisible = !status.playlistVisible" title="Show Playlist"><i class="fa fa-lg fa-list"></i></button>
					<button id ="backBtn" onclick="back();" title="Previous Track"><i class="fa fa-lg fa-step-backward"></i></button>
					<button id ="playBtn" onclick="playPause();" title="Play/Pause" :class="{ active: isActive, paused: isPaused }"><i class="fa fa-lg fa-play"></i></button>
					<button id ="nextBtn" onclick="next();" title="Next Track"><i class="fa fa-lg fa-step-forward"></i></button>
					<button id ="shuffle" onclick="playNext();" title="Play Random"><i class="fa fa-lg fa-random"></i></button>
					<button id ="muteBtn" onclick="mute();" title="Mute"><i class="fa fa-lg fa-volume-up"></i></button>
					<input type="range" min="0" max="1000" id="vol" step="1" oninput="setVol(value)" title="Volume">
					<input type="range" min="-1" max="1" default="0" list="balanceCenter" id="bal" step="0.02" oninput="setBalance(value)" title="Balance" style="width:80px;">
					<datalist id="balanceCenter"><option value="0"></datalist>
					<button id ="deviceBtn" onclick="ipcRenderer.send('message', 'showOptions')" title="Select Audio Output Device"><i class="material-icons">speaker</i></button>
				</div>
			</div>

		</div>

		<audio id="currentTrack"></audio>

	</body>

	<script src="lib/vue.min.js"></script>

	<script type="text/x-template" id="item-template">
		<li>
			<div :class="{bold: isFolder}" @click="toggle" @dblclick="play">
				<i v-if="isFolder" class="material-icons">{{open ? 'folder_open' : 'folder'}}</i>
				<i v-if="!isFolder" class="material-icons">music_note</i>
				{{model.name}}
			</div>
			<ul v-show="open" v-if="isFolder">
				<item class="item" v-for="model in model.children" :model="model"></item>
			</ul>
		</li>
	</script>

	<script src="lib/pouchdb-6.1.2.min.js"></script>
	<script src="lib/pouchdb.upsert.min.js"></script>
	<script src="index.js"></script>

</html>
